"use strict";import{body,modal,container,imgSrc,goodNameText,goodPriceText}from"./script.js";import{orderTpl}from"./orderTemplate.js";function createOrder(){var e=document.createElement("div"),t=(e.classList.add("order"),container.append(e),e.offsetTop),t=(window.scrollTo({top:t,behavior:"smooth"}),document.createElement("div")),e=(t.classList.add("order-wrapper"),e.append(t),t.innerHTML=orderTpl,body.classList.add("under-modal"),document.querySelector(".other-good")),t=document.querySelector(".create-order");e.addEventListener("click",chooseOtherGood),t.addEventListener("click",checkout);const a=document.querySelector(".new-post"),o=document.querySelector(".city"),n=(o.addEventListener("change",function(){"none"!==o.value&&a.removeAttribute("disabled")}),document.querySelector(".fullName"));n.addEventListener("blur",function(){var e=n.value.split(" ");e.length<3&&(n.nextElementSibling.innerHTML="Введіть ПІБ у форматі 'Петренко Петро Петрович'",n.nextElementSibling.classList.add("show")),3===e.length&&n.nextElementSibling.classList.remove("show")})}function chooseOtherGood(e){e.preventDefault(),document.querySelector(".order").remove(),body.classList.remove("under-modal"),window.scrollTo({top:0,behavior:"smooth"})}function checkout(){const a=document.querySelector(".fullName"),o=document.querySelector(".quantity"),n=document.querySelector(".city"),i=document.querySelector(".new-post"),r=document.querySelectorAll(".payment"),l=document.querySelector(".fieldset-radio"),d=document.querySelector(".comment-textarea");function s(e){var t=e.nextElementSibling;if(e.hasAttribute("required")&&""===e.value.trim()&&"fullName"===e.name&&(t.innerHTML="Це поле не може бути порожнім",t.classList.add("show")),e.hasAttribute("required")&&""===e.value.trim()&&"quantity"===e.name&&(t.innerHTML="Це поле не може бути порожнім",t.classList.add("show")),"city"===e.name&&"none"===e.value&&(t.innerHTML="Будь ласка, оберіть своє місто",t.classList.add("show")),"comment"===e.name&&1<=e.value.length&&e.value.length<10&&(t.innerHTML="Коментар повинен бути не менше 10 символів",t.classList.add("show")),"newPost"!==e.name||"none"!==e.value||e.hasAttribute("disabled")||(t.innerHTML="Будь ласка, оберіть відділення",t.classList.add("show")),"radio"===e.type)for(let e=0;e<r.length;e++){if(r[e].checked)return;0!==e||r[e].checked||r[e+1].checked||(l.lastElementChild.innerHTML="Будь ласка, оберіть варіант оплати",l.lastElementChild.classList.add("show"))}r.forEach(e=>e.addEventListener("change",()=>{l.lastElementChild.classList.remove("show")})),a.addEventListener("input",function(){""===a.value&&(a.nextElementSibling.innerHTML="Це поле не може бути порожнім",a.nextElementSibling.classList.add("show"))}),o.addEventListener("input",function(){1<=o.value&&o.nextElementSibling.classList.remove("show")}),n.addEventListener("change",function(){"none"!==n.value&&(n.nextElementSibling.classList.remove("show"),i.removeAttribute("disabled"))}),i.addEventListener("change",function(){"none"!==i.value&&i.nextElementSibling.classList.remove("show")}),d.addEventListener("input",function(){d.value.length<10&&1<=d.value.length&&(d.nextElementSibling.innerHTML="Коментар повинен бути не менше 10 символів",d.nextElementSibling.classList.add("show")),(10<=d.value.length||0===d.value.length)&&d.nextElementSibling.classList.remove("show")})}document.orderForm.addEventListener("submit",function(e){e.preventDefault(),[...this.elements].filter(e=>"submit"!==e.type).forEach(s);var t=[...document.querySelectorAll(".error-span")];let a=[];for(let e=0;e<t.length;e++){if(t[e].classList.contains("show"))return void(a=[]);a.push("success")}0<a.length&&showOrders()})}function serialize(e){var t,a,o={};for([t,a]of new FormData(e))o[t]=a;return o}const fullNameText=document.querySelector(".full-name-text"),goodDetailImgItem=document.querySelector(".good-detail-img-item"),goodDetailName=document.querySelector(".good-detail-name"),goodDetailPrice=document.querySelector(".good-detail-price"),quantityText=document.querySelector(".quantity-text"),cityText=document.querySelector(".city-text"),newPostText=document.querySelector(".new-post-text"),paymentText=document.querySelector(".payment-text"),commentText=document.querySelector(".comment-text"),totalText=document.querySelector(".total-text");function showOrders(){var e=serialize(document.orderForm);fullNameText.innerHTML=`<span class = "key">ПІБ: </span>
                                <span class = "value">${e.fullName}</span>`,goodDetailImgItem.setAttribute("src",imgSrc),goodDetailName.innerHTML=goodNameText,goodDetailPrice.innerHTML=goodPriceText,quantityText.innerHTML=`<span class = "key">Кількість: </span>
                                <span class = "value">${e.quantity}</span>`,cityText.innerHTML=`<span class = "key">Місто: </span>
                            <span class = "value">${e.city}</span>`,newPostText.innerHTML=`<span class = "key">Відділення Нової пошти: </span>
                            <span class = "value">${e.newPost}</span>`,paymentText.innerHTML=`<span class = "key">Варіант оплати: </span>
                            <span class = "value">${e.payment}</span>`,commentText.innerHTML=`<span class = "key">Коментарій: </span>
                            <span class = "value">${e.comment}</span>`,totalText.innerHTML=`<span class = "key">Загальна вартість: </span>
                            <span class = "goods-price">${+goodPriceText.replace(" ","").replace("грн.","")*e.quantity} грн.</span>`,modal.classList.add("active-popup")}const data=[{category:"Телефони",dataId:"phones",phones:[{goodId:"samsung",samsung:[{name:"Мобильный телефон Samsung Galaxy S22 8/128GB Green ",img:"./img/samsungphone.jpeg",price:"30 090 грн.",description:"Екран (6.6\", PLS, 2408x1080) / Qualcomm Snapdragon 680 (2.4 ГГц + 1.9 ГГц) / основна квадрокамера: 50 Мп + 5 Мп + 2 Мп + 2 Мп, фронтальна камера 8 Мп / RAM 6 ГБ / 128 ГБ вбудованої пам'яті + microSD (до 1 ТБ) / 3G / LTE / GPS / підтримка 2х SIM-карт (Nano-SIM) / Android 12 / 5000 мА*год"}],name:"Мобильный телефон Samsung Galaxy S22 8/128GB Green ",img:"./img/samsungphone.jpeg",price:"30 090  грн.",description:"Екран (6.6\", PLS, 2408x1080) / Qualcomm Snapdragon 680 (2.4 ГГц + 1.9 ГГц) / основна квадрокамера: 50 Мп + 5 Мп + 2 Мп + 2 Мп, фронтальна камера 8 Мп / RAM 6 ГБ / 128 ГБ вбудованої пам'яті + microSD (до 1 ТБ) / 3G / LTE / GPS / підтримка 2х SIM-карт (Nano-SIM) / Android 12 / 5000 мА*год"},{goodId:"iphone",iphone:[{name:"Мобільний телефон Apple iPhone 14 128GB Starlight",img:"./img/apple14.jpeg",price:"36 999 грн.",description:'Экран (6.1", OLED (Super Retina XDR), 2532x1170) / Apple A15 Bionic / двойная основная камера: 12 Мп + 12 Мп, фронтальная камера: 12 Мп / 128 ГБ встроенной памяти / 3G / LTE / 5G / GPS / Nano-SIM / iOS 16'}],name:"Мобільний телефон Apple iPhone 14 128GB Starlight",img:"./img/apple14.jpeg",price:"36 999 грн.",description:'Экран (6.1", OLED (Super Retina XDR), 2532x1170) / Apple A15 Bionic / двойная основная камера: 12 Мп + 12 Мп, фронтальная камера: 12 Мп / 128 ГБ встроенной памяти / 3G / LTE / 5G / GPS / Nano-SIM / iOS 16'}]},{category:"Ноутбуки",dataId:"laptops",laptops:[{goodId:"apple",apple:[{name:'Ноутбук Apple MacBook Air 13" M1 256GB 2020 ',img:"./img/macbook2.jpg.webp",price:"44 599 грн.",description:'Экран 15.6" (1366x768) WXGA HD, матовый / Intel Core i3-1005G1 (1.2 - 3.4 ГГц) / RAM 8 ГБ / SSD 256 ГБ / Intel UHD Graphics / без ОД / Wi-Fi / Bluetooth / веб-камера / Windows 11 Home / 1.8 кг / серый'}],name:'Ноутбук Apple MacBook Air 13" M1 256GB 2020',img:"./img/macbook2.jpg.webp",price:"44 599 грн."},{goodId:"acer",acer:[{name:"Ноутбук ASUS Laptop X515JA-BR3971W",img:"./img/acer.webp",price:"38 999 грн.",description:"Екран 15.6” IPS (1920x1080) Full HD 144 Гц, матовий / Intel Core i5-11400H (2.7 - 4.5 ГГц) / RAM 16 ГБ / SSD 512 ГБ / nVidia GeForce RTX 3050 Ti, 4 ГБ / без ОД / LAN / Wi-Fi / Bluetooth / веб-камера / без ОС / 2.2 кг / чорний"}],name:"Ноутбук ASUS Laptop X515JA-BR3971W",img:"./img/acer.webp",price:"38 999 грн."}]},{category:"Монітори",dataId:"monitors"},{category:"Планшети",dataId:"tablets",tablets:[{goodId:"iPod",iPod:[{name:'Планшет Apple iPad Pro 11" M2 Wi-Fi 128GB Space Gray',img:"./img/ipad.webp",price:"41 499 грн.",description:'Экран 11" Liquid Retina (2388x1668) MultiTouch / Apple M2 / 128 ГБ встроенной памяти / Wi-Fi / Bluetooth 5.3 / основная двойная камера 12 Мп + 10 Мп, фронтальная - 12 Мп / iPadOS 16 / 466 г / космический серый'}],name:'Планшет Apple iPad Pro 11" M2 Wi-Fi 128GB Space Gray',img:"./img/ipad.webp",price:"41 499 грн.",description:'Экран 11" Liquid Retina (2388x1668) MultiTouch / Apple M2 / 128 ГБ встроенной памяти / Wi-Fi / Bluetooth 5.3 / основная двойная камера 12 Мп + 10 Мп, фронтальная - 12 Мп / iPadOS 16 / 466 г / космический серый'},{goodId:"galaxy",galaxy:[{name:"Планшет Samsung Galaxy Tab S8+ 5G 128 GB Graphite",img:"./img/samsung.jpeg",price:"42 999 грн.",description:"Екран 12.4\" (2800x1752) MultiTouch / Qualcomm Snapdragon 8 Gen 1 (3.0 ГГц) / RAM 8 ГБ / 128 ГБ вбудованої пам'яті + microSD / 3G / 4G / 5G / Wi-Fi / Bluetooth 5.2 / подвійна основна камера: 13 Мп + 6 Мп, фронтальна — 12 Мп / Android 12 / 572 г / графітовий"}],name:"Планшет Samsung Galaxy Tab S8+ 5G 128 GB Graphite",img:"./img/samsung.jpeg",price:"42 999 грн.",description:"Екран 12.4\" (2800x1752) MultiTouch / Qualcomm Snapdragon 8 Gen 1 (3.0 ГГц) / RAM 8 ГБ / 128 ГБ вбудованої пам'яті + microSD / 3G / 4G / 5G / Wi-Fi / Bluetooth 5.2 / подвійна основна камера: 13 Мп + 6 Мп, фронтальна — 12 Мп / Android 12 / 572 г / графітовий"}]}],orderTpl=`      
        <div class = "form">
            <form name = "orderForm" novalidate>
                <div class = flex-wrapper>                        
                    <div class = "left-flex">
                        <label class = input-box>
                            Вкажіть своє прізвище, ім'я та по-батькові *
                            <input type = "text" name = "fullName" class = "fullName" placeholder = "ПІБ" required>
                            <span class = "error-span"></span>
                        </label>
                        <label class = input-box>
                            Вкажіть кількість товару *
                            <input type = "number"  min = "1" name = "quantity" class = "quantity" placeholder = "Кількість товару" required>
                            <span class = "error-span"></span>
                        </label>
                        <label class="input-box">
                            Оберіть своє місто *
                            <select type = "select" name="city" class = "city" required>
                                <option value="none" disabled selected>Оберіть своє місто</option>
                                <option value="Київ">Київ</option>
                                <option value="Харків">Харків</option>
                                <option value="Львів">Львів</option>
                                <option value="Одеса">Одеса</option>
                            </select> 
                            <span class = "error-span"></span>                   
                        </label>
                        <label class="input-box">
                            Оберіть відділення Нової пошти *
                            <select name="newPost" class = "new-post" required disabled>
                                <option value="none" disabled selected>Оберіть відділення Нової пошти</option>
                                <option value="Відділення 1">Відділення 1</option>
                                <option value="Відділення 2">Відділення 2</option>
                                <option value="Відділення 3">Відділення 3</option>
                                <option value="Відділення 4">Відділення 4</option>
                            </select> 
                            <span class = "error-span"></span>                  
                        </label>
                    </div>
                    <div class = "right-flex">
                        <fieldset class="input-box fieldset-radio">
                            <legend>Варіант оплати *</legend>
                                <label>
                                    <input type="radio" name="payment" value="Післяплата" class = "payment">
                                    Післяплата
                                </label>
                                <label>
                                    <input type="radio" name="payment" value="Оплата банківською картою" class = "payment">
                                    Оплата банківською картою
                                </label>
                                <span class = "error-span"></span>                                
                        </fieldset>
                        <label class="input-box textarea-box">
                            Коментар до замовлення
                            <textarea placeholder = "Коментар до замовлення" name = "comment" class = "comment-textarea"></textarea>
                            <span class = "error-span"></span> 
                        </label> 
                    </div>                
                </div>            

                <div class = "buttons">
                    <button class = "create-order" type="submit">Оформити замовлення</button>
                    <button class = "other-good" type="submit">Обрати інший товар</button>
                </div>
            </form>
        </div>
    `;function generateUL(e){let o=document.createElement("ul");return o.classList.add("categories-list"),e.forEach(function(e){var t=document.createElement("li"),a=(t.innerText=e.category,t.classList.add("categories-item"),e.dataId);t.setAttribute("data-dataid",a),0<e.children?.length&&t.append(generateUL(e.children)),o.append(t)}),o}import{generateUL}from"./renderCategories.js";import{data}from"./data.js";const modal=document.querySelector(".popup-wrapper"),okBtn=document.querySelector(".of-btn"),goodsWrapper=document.querySelector(".goods-wrapper"),buyWrapper=document.querySelector(".buy-wrapper"),goodCardWrapper=document.querySelector(".goods-card-wrapper"),body=document.querySelector("body"),categories=document.querySelector(".categories"),ul=generateUL(data),categoriesList=(categories.append(ul),document.querySelector(".categories-list")),goodsTpl=`      
    <div class="goods-card" data-dataid="{goodId}">
        <img src="{img}" alt="goods" data-dataid="{goodId}" class="goods-img">
        <h3 class="goods-name" data-dataid="{goodId}">{name}</h3>
        <p class="goods-price" data-dataid="{goodId}">{price}</p>
    </div>
`;let goodsHeader=document.createElement("h2");goodsHeader.classList.add("goods-header"),goodsWrapper.prepend(goodsHeader),categoriesList.addEventListener("click",e=>{if(e.target.closest(".categories-item")){goodsWrapper.classList.remove("hidden"),buyWrapper.innerHTML="",console.log(addEventListener);const t=e.target.dataset.dataid,a=(console.log(t),data.findIndex(e=>e.dataId===t));console.log(a);e=data[a][t];console.log(e),goodsHeader.innerHTML=data[a].category,e?(goodCardWrapper.innerHTML=e.map(e=>goodsTpl.replaceAll("{img}",e.img).replaceAll("{name}",e.name).replaceAll("{price}",e.price).replaceAll("{goodId}",e.goodId)).join(""),document.querySelectorAll(".goods-card").forEach(e=>{e.setAttribute("data-dataparentid",data[a].dataId)}),document.querySelectorAll(".goods-img").forEach(e=>{e.setAttribute("data-dataparentid",data[a].dataId)}),document.querySelectorAll(".goods-name").forEach(e=>{e.setAttribute("data-dataparentid",data[a].dataId)}),document.querySelectorAll(".goods-price").forEach(e=>{e.setAttribute("data-dataparentid",data[a].dataId)})):goodCardWrapper.innerHTML='<div class = "default-text">У даній категорії наразі відсутні товари</div>'}});const buyTpl=`      
           <h3 class="buy-title">{title}</h3>
            <img src={img} alt="buy" class="buy-img">
           <p class="buy-description">{description}</p>
            <p class="goods-price">{price}</p>
           <div class="button-wrapper">
               <button class = "buy-btn">Купити</button>
            </div>
    `;function closePopup(){modal.classList.remove("active-popup"),goodCardWrapper.innerHTML="",buyWrapper.innerHTML="",goodsHeader.innerHTML="",document.body.classList.add("under-modal");var e=document.querySelector(".name1"),t=document.querySelector(".info2"),a=document.querySelector(".np1"),o=document.querySelector(".payment"),n=document.querySelector(".number"),i=document.querySelector(".comment");goodsWrapper.innerHTML=`<div>${i.value}</div><div>${n.value}</div><div>${o.value}</div><div>${a.value}</div><div>${t.value}</div><div>${e.value}</div>`,document.body.classList.add("under-modal")}function init(){function t(e){var t=e.nextElementSibling;t&&t.classList.contains("error-message")&&(e.hasAttribute("required")&&""===e.value.trim()?t.innerHTML="Це поле обовязкове для заповнення":"text"===e.type&&А-Я.test(e.value)?t.innerHTML="Поле ПІБ покупця не може бути порожнім":"number"===e.type&&0===e.selectedIndex?t.innerHTML="Будь ласка, виберіть кількість":t.innerHTML="")}document.myForm.addEventListener("submit",function(e){console.log(this.elements),console.log([...this.elements]),e.preventDefault(),[...this.elements].filter(e=>"submit"!==e.type).forEach(t)}),document.querySelectorAll("input").forEach(e=>{e.addEventListener("blur",function(){t(this)})})}goodsWrapper.addEventListener("click",e=>{if(e.target.closest(".goods-card")){const a=e.target.dataset.dataparentid,o=e.target.dataset.dataid;var e=data.findIndex(e=>e.dataId===a),e=data[e][a],t=e.findIndex(e=>e.goodId===o),e=e[t][o];buyWrapper.innerHTML=e.map(e=>buyTpl.replaceAll("{title}",e.name).replaceAll("{img}",e.img).replaceAll("{description}",e.description).replaceAll("{price}",e.price)).join(""),document.querySelector(".buy-btn").addEventListener("click",()=>{modal.classList.add("active-popup"),document.body.classList.add("under-modal")})}}),okBtn.addEventListener("click",closePopup),window.addEventListener("load",init);export{createOrder,data,orderTpl,generateUL};